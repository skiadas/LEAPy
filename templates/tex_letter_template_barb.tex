\documentclass[12pt]{article}
\usepackage[vmargin=1in, hmargin=1in]{geometry}
\usepackage{setspace}
\usepackage{paralist}
\doublespacing
\pagestyle{empty}
\begin{document}

\pyblock{for rm, stds in itools.groupby(students, helpers.room)}
	\newpage
	{\ }
		\vfill
	\begin{center}
	{\Huge
	\textbf{Room\\
	\vspace{0.5in}
	\pyvar{rm}}
	}\\
	\vfill
	\pyblock{for st in helpers.students_room(rm, students)}
		\pyvar{st.last}, \pyvar{st.first}, \pyvar{st.placement.short} (\pyvar{st.acad})\\
	\pyblock{endfor}
	\end{center}
	\vfill
	\pyblock{for st in stds}
		\newpage
		{\Large Student: \pyvar{st.last}, \pyvar{st.first}\\
		Placement: \pyvar{st.placement.short} (\pyvar{st.placement.name})
		}
		\vspace{0.2in}
		\hrule
		\vspace{0.6in}
		\noindent\today\\

		\vspace{0.2in}
		\noindent Dear \pyvar{st.first},
		\vspace{0.2in}

		Thank you for taking the calculus interest survey and the online placement exam.
		\pyblock{if not(st.placement.code == "dept")}
    		 Based on your survey responses and exam score, the Math department recommends you begin calculus at Hanover by taking \pyvar{st.placement.short}.  
    		\pyblock{if st.is_premed()}
    			You should talk with your pre-health advisor about whether or not to take calculus your first semester (Fall \the\year).
    		\pyblock{endif}
		
    		\pyblock{if st.placement.code == "Mat 121e"}
    		Depending on how much calculus you have learned in high school, and how much you want to push yourself during your first semester at Hanover, you may wish to skip Math 121 and begin instead with Math 122 (Calculus II).  Please discuss this option with me during LEAP if you are interested.
    		\pyblock{endif}
    	\pyblock{endif}
    	\pyblock{if st.placement.code == "dept"}
    	The department was not able to place you in a Calculus course.
    	\pyblock{if st.placement_score < 10}
    	Your score in the placement test was very low, under \( 10 \), indicating difficulties with the precalculus material needed for our Calculus sequences.
	    \pyblock{endif}
	    \pyblock{if st.placement_score >= 10 and not(st.has_precalc()) and not(st.has_calc())}
        You indicated on your survey that you have taken neither precalculus nor calculus in high school.
        \pyblock{endif}
	    Based on this, the department did not think you were ready to take Calculus. If you feel that this information was incorrect, and you want to take Calculus at Hanover, please talk to me at some point during LEAP. Depending on what major you are interested in pursuing, other options might be more suitable. We can discuss these further if you like.
    	\pyblock{endif}
    	
		If you have any questions or concerns about mathematics at Hanover College, please feel free to talk them over with me during LEAP, or contact the math department by email at \texttt{mathplacement@hanover.edu}
		\vspace{0.5in}

		\noindent Best regards,\\
		Barbara Wahl\\
		Department of Mathematics \& Computer Science\\
		Hanover College
	\pyblock{endfor}
\pyblock{endfor}
\end{document}